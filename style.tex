\usepackage[top=1in,bottom=1in,left=2cm,right=4cm,marginparwidth=75pt]{geometry}
\usepackage[texindy]{imakeidx}
\makeindex[intoc]
\usepackage[dvipsnames]{xcolor}
\definecolor{Darkgreen}{rgb}{0,0.4,0}



%header, footers
\usepackage[
automark,
autooneside=false,
headsepline
]{scrlayer-scrpage}
\clearpairofpagestyles
\lehead{\pagemark}
\rohead{\pagemark}
\rehead{\em \theauthor}
\lohead{\ifstr{\leftmark}{\rightbotmark}{}{\rightbotmark}}



\usepackage[explicit]{titlesec}

\setcounter{tocdepth}{1}

\RedeclareSectionCommands{section}
\RedeclareSectionCommands{subsection}

\usepackage{etoolbox}
\usepackage[linktoc=page]{hyperref}
\hypersetup{
colorlinks=true,
linkcolor=ForestGreen,
citecolor=RawSienna
}


\usepackage{titletoc}


%Motion Mountain style toc
\titlecontents{chapter}[0pt]
{\vskip15pt\llap{\makebox[3em]{{\thecontentspage\hfill\thecontentslabel}}\hskip1em}
    \small\bfseries\vskip-\baselineskip}{}{}{}
\titlecontents*{section}[20pt]
{\upshape}{}{}
{\, \oldstylenums{\thecontentspage}}[][\ \textbullet\ ][]


\usepackage{amsmath, amsthm, thmtools}


\setkomafont{disposition}{\bfseries\rmfamily}
\usepackage[object=vectorian]{pgfornament}
\usepackage{titling}
\usepackage{xparse}
\usepackage{lipsum}

%page borders
\usepackage{eso-pic}
\newcommand\AtPageUpperRight[1]{\AtPageUpperLeft{%
        \put(\LenToUnit{\paperwidth},\LenToUnit{0\paperheight}){#1}%
}}%
\newcommand\AtPageLowerRight[1]{\AtPageLowerLeft{%
        \put(\LenToUnit{\paperwidth},\LenToUnit{0\paperheight}){#1}%
}}%

\AddToShipoutPictureBG{%
    \AtPageUpperLeft{\put(0,-25){\pgfornament[width=1.75cm]{61}}}
    \AtPageUpperRight{\put(-50,-25){\pgfornament[width=1.75cm,symmetry=v]{61}}}
    \AtPageLowerLeft{\put(0,25){\pgfornament[width=1.75cm,symmetry=h]{61}}}
    \AtPageLowerRight{\put(-50,25){\pgfornament[width=1.75cm,symmetry=c]{61}}}
}

%part formatting
\titleformat{\part}[display]
{\Huge\filcenter}
{ \hspace*{1.5cm} \partname \, {\bfseries \color{purple}\thepart}}
{2em}
{\hspace{1.5cm}\pgfornament{87}%
    \vspace{2em}%
    \begin{center}
        \hspace{1.5cm}{\em#1}
    \end{center}
}


%section formatting
\renewcommand*{\sectionformat}%
{\color{purple}\S\thesection\enskip}
\renewcommand*{\subsectionformat}%
{\color{purple}\S\thesubsection\enskip}
\renewcommand*{\subsubsectionformat}%
{\color{purple}\S\thesubsubsection\enskip}
\addtokomafont{paragraph}{\color{orange!35!black}\P\ }
\KOMAoptions{numbers=noenddot}




%chapter formatting
\titleformat{\chapter}[display]
{\bfseries\Large}
{\filleft\MakeUppercase{\chaptertitlename} \Huge{\color{purple}\thechapter}}
{8pt}
{
    \pgfornament{89}%
    \vspace{2ex}%
    \begin{center}
     \pgfornament[scale=0.4]{79}\huge\bfseries\filcenter \enspace  #1 \enspace \pgfornament[scale=0.4]{78}
    \end{center}
}

%for description(subtitle)
\newcommand{\descrip}[1]{\def \thedescrip{#1}}

%Fancy titlepage
\NewDocumentCommand{\fncytitle}{s}{
    \begin{titlepage}
        \topskip0pt
        \vspace*{10em}
        \begin{center}
            \hspace{1.5cm}{\pgfornament[scale=0.35, ydelta=-7pt, symmetry=v]{11} \em \Huge  \thetitle \ \pgfornament[scale=0.35, ydelta=-7pt]{11}}
            {\par \vspace*{1em}\hspace{20em} \emph{\thedescrip}  \large }
        \end{center}
        \vspace{14em}
        { 
        \begin{center}
           \hspace{1.5cm} {\bfseries \LARGE \theauthor}
        \end{center}
        }
        \vspace*{14em}
        { 
        \begin{center}  
            \hspace{1.5cm}{\bfseries \Large \thedate}    
        \end{center}`'
        }
    \end{titlepage}
}
%bold pages
\addtokomafont{pagenumber}{\bfseries}



%some graph stuff
\usepackage[nameinlink]{cleveref}
\usepackage{todonotes}
\usepackage{tikz}
  \usetikzlibrary{arrows.meta,}
\usepackage{pgfplots}
\pgfplotsset{width=7cm,compat=1.18}
\pgfplotsset{
    funcgraphbare/.style={
        axis x line=center,
        axis y line=center,
        ticks=none,
    },
    funcgraph/.style={
        funcgraphbare,
        xlabel={\(x\)},
        ylabel={\(y\)},
    },
}


\usepackage{physics}
\usepackage{mathdots}
\usepackage{tkz-euclide}
\usepackage{babel}
\usepackage{float}
\usepackage{caption}

\makeatletter
\newenvironment{chapquote}[2][8em]
  {\setlength{\@tempdima}{#1}%
   \def\chapquote@author{#2}%
   \parshape 1 \@tempdima \dimexpr\textwidth-2\@tempdima\relax%
   \itshape}
  {\par \normalfont\hfill--\ \chapquote@author\hspace*{\@tempdima}\par\bigskip}
\makeatother

\usepackage{epigraph}

\setlength\epigraphwidth{8cm}

\makeatletter
\patchcmd{\epigraph}{\@epitext{#1}}{\itshape\@epitext{#1}}{}{}
\makeatother

\usepackage{lettrine}

\let\cleardoublepage=\clearpage
